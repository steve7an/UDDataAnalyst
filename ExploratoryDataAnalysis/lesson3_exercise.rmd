---
title: "Lesson3_exercises"
author: "steve7an"
date: "26/10/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r diamonds}
library(ggplot2) #must load the ggplot package first
data(diamonds) #loads the diamonds data set since it comes with the ggplot package

summary(diamonds)

?diamonds

summary(diamonds$color)

str(diamonds)
```

# Create a histogram of the price of
# all the diamonds in the diamond data set.

# TYPE YOUR CODE BELOW THE LINE
# =======================================


```{r pressure, echo=FALSE}
summary(diamonds$price)

qplot(data=diamonds, x=price, 
      color=I('black'), fill=I('#099DD9'),
      xlab = "Price of Diamonds", ylab= "Number of Diamonds") +
    scale_x_continuous(limits = c(300, 18820), breaks=seq(300,18820, 1000))

```

Diamond counts

```{r}
print (sum(diamonds$price < 500))

print (sum(diamonds$price < 250))

print (sum(diamonds$price >= 15000))

```

# Explore the largest peak in the
# price histogram you created earlier.

# Try limiting the x-axis, altering the bin width,
# and setting different breaks on the x-axis.

# There won’t be a solution video for this
# question so go to the discussions to
# share your thoughts and discover
# what other people find.

# You can save images by using the ggsave() command.
# ggsave() will save the last plot created.
# For example...
#                  qplot(x = price, data = diamonds)
#                  ggsave('priceHistogram.png')

# ggsave currently recognises the extensions eps/ps, tex (pictex),
# pdf, jpeg, tiff, png, bmp, svg and wmf (windows only).

# Submit your final code when you are ready.

# TYPE YOUR CODE BELOW THE LINE
# ======================================================================

```{r}
qplot(data=diamonds, x=price, binwidth=1,
      color=I('#099DD9'), fill=I('#099DD9'),
      xlab = "Price of Diamonds", ylab= "Number of Diamonds") +
    scale_x_continuous(limits = c(200, 18820), breaks=seq(300,18820, 500))
ggsave(filename="priceHistogram.png", width = 15, height = 12, dpi = 75, units = "in", device='png')
```

Exploring the gap in the data between 1300 and 1800

```{r}
minvalue = 1400
maxvalue = 1550

qplot(data=diamonds, x=price, color=I('black'), fill=I('orange'), binwidth=1, 
      xlab = "Price of Diamonds", ylab= "Number of Diamonds") +
    scale_x_continuous(limits = c(minvalue, maxvalue), breaks=seq(minvalue,maxvalue, 5)) +
    coord_cartesian(xlim=c(minvalue, maxvalue))
ggsave(filename="priceGap.png", width = 30, height = 8, dpi = 75, units = "in", device='png')

```

## Doing the same exploration with the gap dataset
```{r}
# if you are interested in the data that generates the graph:
gapdata <-cut(diamonds$price, breaks = seq(1450, 1550, by = 1))

# you can view the frequency distribution using table:
table(gapdata)

```

## Exploring the max value area of the histogram

```{r}
minvalue <- 600
maxvalue <- 750
qplot(data=diamonds, x=price, color=I('black'), fill=I('orange'), binwidth=1, 
      xlab = "Price of Diamonds", ylab= "Number of Diamonds") +
    scale_x_continuous(limits = c(minvalue, maxvalue), breaks=seq(minvalue,maxvalue, 5)) +
    coord_cartesian(xlim=c(minvalue, maxvalue))
ggsave(filename="priceMax.png", width = 30, height = 8, dpi = 75, units = "in", device='png')

```

## Exploring the max dataset further

```{r}
# if you are interested in only 'price'
newddata <- subset(diamonds, price >= 350 & price < 1000, select=c(price)) 
# if you are interested in all data for that price range:
newddata2 <- subset(diamonds, price >= 350 & price < 1000)

# if you are interested in the data that generates the graph:
cutddata <-cut(diamonds$price, breaks = seq(600, 750, by = 1))

# you can view the frequency distribution using table:
table(cutddata)

# and the mode by sorting the table data and selecting the highest frequency
names(sort(-table(cutddata)))[1]
```

# Break out the histogram of diamond prices by cut.

# You should have five histograms in separate
# panels on your resulting plot.

# TYPE YOUR CODE BELOW THE LINE
# ======================================================
```{r}
minvalue = 0
maxvalue = 19000
levels(diamonds$cut)

library(gridExtra)

plotdata <- function(sel_cut, color) {
    sel_data <- subset(diamonds, cut==sel_cut, select=c(price)) 
    maxvalue = max(sel_data)
    
    print (paste("Summary of cut: ",  sel_cut, sep=""))
    print (summary(sel_data))
    
    histplot <- qplot(data=sel_data, x=price, color=I('black'), fill=I(color), binwidth=300, 
          xlab = "Price of Diamonds", ylab= "Number of Diamonds") +
        scale_x_continuous(limits = c(minvalue, maxvalue), breaks=seq(minvalue,maxvalue, 1000)) 
    
    return (histplot)
}

fair_plot <- plotdata("Fair","orange")
good_plot <- plotdata("Good","blue")
verygood_plot <- plotdata("Very Good","green")
premium_plot <- plotdata("Premium","brown")
ideal_plot <- plotdata("Ideal","red")

grid.arrange(fair_plot, good_plot, verygood_plot, premium_plot, ideal_plot, ncol=1)

```

## Alternative solution

# Notes
1. http://www.cookbook-r.com/Graphs/Facets_(ggplot2)/

```{r}
minvalue = 0
maxvalue = 19000
qplot(data=diamonds, x=price, color=I('black'), fill=I("blue"), binwidth=300, 
          xlab = "Price of Diamonds", ylab= "Number of Diamonds") +
        facet_wrap(~cut)
```

# In the two last exercises, we looked at
# the distribution for diamonds by cut.

# Run the code below in R Studio to generate
# the histogram as a reminder.

# ===============================================================

```{r}
qplot(x = price, data = diamonds) + facet_wrap(~cut)
```

# Look up the documentation for facet_wrap in R Studio.
# Then, scroll back up and add a parameter to facet_wrap so that
# the y-axis in the histograms is not fixed. You want the y-axis to
# be different for each histogram.

```{r}
qplot(x = price, data = diamonds) + facet_wrap(~cut,  scales="free_y")
```


# Create a histogram of price per carat
# and facet it by cut. You can make adjustments
# to the code from the previous exercise to get
# started.

# Adjust the bin width and transform the scale
# of the x-axis using log10.

# Submit your final code when you are ready.

# ENTER YOUR CODE BELOW THIS LINE.
# ===========================================================================
```{r}
qplot(x = log10(price), data = diamonds) + facet_wrap(~cut,  scales="free_y")
```

## alternative solution
```{r}
qplot(x = price, data = diamonds, binwidth=0.01) +
facet_wrap(~cut,  scales="free_y") +
    scale_x_log10()
```


# Investigate the price of diamonds using box plots,
# numerical summaries, and one of the following categorical
# variables: cut, clarity, or color.

# There won’t be a solution video for this
# exercise so go to the discussion thread for either
# BOXPLOTS BY CLARITY, BOXPLOT BY COLOR, or BOXPLOTS BY CUT
# to share you thoughts and to
# see what other people found.

# You can save images by using the ggsave() command.
# ggsave() will save the last plot created.
# For example...
#                  qplot(x = price, data = diamonds)
#                  ggsave('priceHistogram.png')

# ggsave currently recognises the extensions eps/ps, tex (pictex),
# pdf, jpeg, tiff, png, bmp, svg and wmf (windows only).

# Copy and paste all of the code that you used for
# your investigation, and submit it when you are ready.
# =================================================================

```{r}
qplot(x = color, y= price, data = diamonds, geom = "boxplot")
ggsave(filename="priceColorBoxplot.png", width = 15, height = 4, dpi = 75, units = "in", device='png')
```
```{r}
tapply(diamonds$price, diamonds$color, summary)
```

